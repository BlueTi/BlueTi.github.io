---
emoji: ğŸ§¢
title: 'êµ¬ìŠ¬ íƒˆì¶œ 2'
date: '2021-06-18T15:16:37.121Z'
categories: ì•Œê³ ë¦¬ì¦˜
author: Jard
description: 'ë°±ì¤€ 13460ë²ˆ ê·¸ë˜í”„ì´ë¡  ë¬¸ì œ'
---

[![ë°±ì¤€](https://d2gd6pc034wcta.cloudfront.net/images/logo@2x.png)](https://www.acmicpc.net/problem/13460)

<div style="text-align:center"><a href="https://www.acmicpc.net/problem/13460">https://www.acmicpc.net/problem/13460</a></div>

---

- êµ¬ìŠ¬ì´ ì–´ë”˜ê°€ ë¶€ë”›íë•Œê¹Œì§€ ì›€ì§ì¸ë‹¤.
- ë¹¨ê°„ êµ¬ìŠ¬ê³¼ íŒŒë€ êµ¬ìŠ¬ì€ ê²¹ì³ì§€ì§€ ì•ŠëŠ”ë‹¤.
- íŒŒë€ êµ¬ìŠ¬ê³¼ ë¹¨ê°„ êµ¬ìŠ¬ì´ ê°™ì€ ë°©í–¥ìœ¼ë¡œ ë™ì‹œì— ë¹ ì§ˆ ê²½ìš° ì‹¤íŒ¨.
- íŒŒë€ êµ¬ìŠ¬ì´ ë¨¼ì € ë¹ ì ¸ë„ ì•ˆëœë‹¤.
- 10ë²ˆ ì´ë‚´ í•´ì•¼í•˜ê³  ê·¸ëŸ¬ì§€ ëª» í•  ê²½ìš° -1ì„ ì¶œë ¥.

---

```java
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.util.LinkedList;
import java.util.Queue;
import java.util.StringTokenizer;

/**
 * êµ¬ìŠ¬ íƒˆì¶œ 2 ë¬¸ì œ í•´ê²°
 * BFSë¥¼ ì‚¬ìš©í•˜ì—¬ ìµœì†Œ ì´ë™ íšŸìˆ˜ë¥¼ ì°¾ëŠ” ë¬¸ì œ
 * ë¹¨ê°„ êµ¬ìŠ¬ë§Œ êµ¬ë©ì— ë¹ ëœ¨ë¦¬ëŠ” ìµœì†Œ íšŸìˆ˜ë¥¼ êµ¬í•¨
 */
public class Main {
    static BufferedReader br;
    static BufferedWriter bw;

    public static void main(String[] args) throws IOException {
        br = new BufferedReader(new InputStreamReader(System.in));
        bw = new BufferedWriter(new OutputStreamWriter(System.out));
        StringTokenizer st = new StringTokenizer(br.readLine());
        int n = Integer.parseInt(st.nextToken()), m = Integer.parseInt(st.nextToken());
        char[][] map = new char[n][m];
        
        // ìƒíƒœë¥¼ ë‹´ì•„ì„œ ì „ë‹¬í•  ë°°ì—´ status
        // 0,1 = ë¹¨ê°„ êµ¬ìŠ¬ y,x ì¢Œí‘œ | 2,3 = íŒŒë€ êµ¬ìŠ¬ y,x ì¢Œí‘œ | 4 = ì´ë™íšŸìˆ˜
        int[] status = new int[5];
        
        // ë¹¨ê°„êµ¬ìŠ¬ìœ„ì¹˜[][] íŒŒë€êµ¬ìŠ¬ìœ„ì¹˜[][]ì— ì˜¨ì ì´ ìˆëŠ”ì§€ ì²´í¬í•  ëª©ë¡
        // 4ì°¨ì› ë°°ì—´ë¡œ ë‘ êµ¬ìŠ¬ì˜ ìœ„ì¹˜ ì¡°í•©ì„ ëª¨ë‘ ì²´í¬
        boolean[][][][] visited = new boolean[n][m][n][m];
        // ë§µ ì •ë³´ë¥¼ ì…ë ¥ë°›ê³  êµ¬ìŠ¬ì˜ ì´ˆê¸° ìœ„ì¹˜ë¥¼ ì €ì¥
        for (int i = 0; i < n; i++) {
            char[] input = br.readLine().toCharArray();
            for (int j = 0; j < m; j++) {
                char c = input[j];
                map[i][j] = c;
                // êµ¬ìŠ¬ì˜ ìœ„ì¹˜ëŠ” ë”°ë¡œ ì €ì¥í•´ë†“ê³  ì§€ë„ ìƒì—ëŠ” .ìœ¼ë¡œ í‘œê¸°
                // (êµ¬ìŠ¬ì€ ì´ë™í•˜ë¯€ë¡œ ë§µì—ëŠ” í‘œì‹œí•˜ì§€ ì•ŠìŒ)
                if (c == 'R') {
                    status[0] = i;
                    status[1] = j;
                    map[i][j] = '.';
                } else if (c == 'B') {
                    status[2] = i;
                    status[3] = j;
                    map[i][j] = '.';
                }
            }
        }

        // BFSë¥¼ ìœ„í•œ í ì´ˆê¸°í™” ë° ì‹œì‘ ìƒíƒœ ì¶”ê°€
        Queue<int[]> queue = new LinkedList<int[]>();
        queue.add(status);

        // ìƒí•˜ì¢Œìš° 4ë°©í–¥ ì´ë™ ì¢Œí‘œ (ì•„ë˜, ìœ„, ì˜¤ë¥¸ìª½, ì™¼ìª½)
        int[][] directions = new int[][] { { 1, 0 }, { -1, 0 }, { 0, 1 }, { 0, -1 } };
        
        // BFS íƒìƒ‰: íê°€ ë¹Œ ë•Œê¹Œì§€ ë°˜ë³µ
        while (!queue.isEmpty()) {
            status = queue.remove();

            // 10ë²ˆ ì´ìƒ ì›€ì§ì¼ ê²½ìš° -1 ì¶œë ¥ì„ ìœ„í•´ status[4]ì— -1ì„ ëŒ€ì…í•˜ê³  whileì¢…ë£Œ
            if (status[4] > 10) {
                status[4] = -1;
                break;
            }

            // íŒŒë€êµ¬ìŠ¬ì´ ë¹ ì§„ ê²½ìš° (íŒŒë€êµ¬ìŠ¬ì´ ë¨¼ì € ë¹ ì§, íŒŒë€êµ¬ìŠ¬ê³¼ ë¹¨ê°„êµ¬ìŠ¬ì´ ë™ì‹œì— ë¹ ì§)
            // ì´ ê²½ìš°ëŠ” ì‹¤íŒ¨ì´ë¯€ë¡œ íì— ë” ë„£ì§€ ì•Šê³  ìƒëµ
            if (map[status[2]][status[3]] == 'O')
                continue;
            // ë¹¨ê°„ êµ¬ìŠ¬ë§Œ ë¹ ì§„ ê²½ìš° ì„±ê³µì´ë¯€ë¡œ while ì¢…ë£Œ
            else if (map[status[0]][status[1]] == 'O')
                break;


            // 4ë°©í–¥ íƒìƒ‰ (ìƒí•˜ì¢Œìš°)
            for (int j = 0; j < 4; j++) {
                int[] dir = directions[j];
                
                // ë¹¨ê°„ êµ¬ìŠ¬ì„ í˜„ì¬ ë°©í–¥ìœ¼ë¡œ êµ´ë¦¬ê¸°
                // êµ¬ìŠ¬ì˜ í˜„ì¬ ìœ„ì¹˜ë¥¼ ë³µì‚¬
                int[] cur_red = new int[] { status[0], status[1] };
                // êµ¬ìŠ¬ì´ êµ¬ë©ì— ë¹ ì§€ê±°ë‚˜ ë²½ì— ë¶€ë”ªí ë•Œê¹Œì§€ ì´ë™
                while (true) {
                    cur_red[0] += dir[0];
                    cur_red[1] += dir[1];
                    if (map[cur_red[0]][cur_red[1]] == 'O' || map[cur_red[0]][cur_red[1]] == '#')
                        break;
                }
                // ë²½ ìœ„ì¹˜ë¡œ ê°„ ê²½ìš° í•œ ì¹¸ ë’¤ë¡œ ë˜ëŒë¦¼ (ë²½ ì•ì— ë©ˆì¶¤)
                if (map[cur_red[0]][cur_red[1]] == '#') {
                    cur_red[0] -= dir[0];
                    cur_red[1] -= dir[1];
                }
                
                // íŒŒë€ êµ¬ìŠ¬ë„ ê°™ì€ ë°©í–¥ìœ¼ë¡œ êµ´ë¦¬ê¸°
                int[] cur_blue = new int[] { status[2], status[3] };
                while (true) {
                    int next_y = cur_blue[0] + dir[0], next_x = cur_blue[1] + dir[1];
                    cur_blue[0] = next_y;
                    cur_blue[1] = next_x;
                    if (map[next_y][next_x] == 'O' || map[next_y][next_x] == '#')
                        break;
                }
                // ë²½ì— ë¶€ë”ªíŒ ê²½ìš° í•œ ì¹¸ ë’¤ë¡œ ë˜ëŒë¦¼
                if (map[cur_blue[0]][cur_blue[1]] == '#') {
                    cur_blue[0] -= dir[0];
                    cur_blue[1] -= dir[1];
                }

                // ë¹¨ê°„ êµ¬ìŠ¬ê³¼ íŒŒë€ êµ¬ìŠ¬ì´ ê°™ì€ ìœ„ì¹˜ì— ë„ë‹¬í•˜ì˜€ìœ¼ë‚˜ êµ¬ë©ì´ ì•„ë‹Œ ê²½ìš°
                // ë‘ êµ¬ìŠ¬ì€ ê²¹ì¹  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ë” ë©€ë¦¬ì„œ ì˜¨ êµ¬ìŠ¬ì„ í•œ ì¹¸ ë’¤ë¡œ ì´ë™ì‹œí‚´
                if (cur_blue[0] == cur_red[0] && cur_blue[1] == cur_red[1] && map[cur_red[0]][cur_red[1]] != 'O') {
                    // ë‘ êµ¬ìŠ¬ì´ ì´ë™í•œ ê±°ë¦¬ë¥¼ ê³„ì‚°í•˜ì—¬ ë” ë©€ë¦¬ì„œ ì˜¨ êµ¬ìŠ¬ì´ ë‚˜ì¤‘ì— ì˜¨ ê²ƒì´ë¯€ë¡œ ê·¸ ì „ ì¹¸ìœ¼ë¡œ ì¡°ì •
                    int red_dis = Math.abs(status[0] - cur_red[0]) + Math.abs(status[1] - cur_red[1]);
                    int blue_dis = Math.abs(status[2] - cur_blue[0]) + Math.abs(status[3] - cur_blue[1]);
                    if (red_dis > blue_dis) {
                        // ë¹¨ê°„ êµ¬ìŠ¬ì´ ë” ë©€ë¦¬ì„œ ì™”ìœ¼ë¯€ë¡œ í•œ ì¹¸ ë’¤ë¡œ
                        cur_red[0] -= dir[0];
                        cur_red[1] -= dir[1];
                    } else {
                        // íŒŒë€ êµ¬ìŠ¬ì´ ë” ë©€ë¦¬ì„œ ì™”ìœ¼ë¯€ë¡œ í•œ ì¹¸ ë’¤ë¡œ
                        cur_blue[0] -= dir[0];
                        cur_blue[1] -= dir[1];
                    }
                }
                
                // í˜„ì¬ êµ¬ìŠ¬ë“¤ì˜ ìœ„ì¹˜ ì¡°í•©ì´ ë°©ë¬¸í•œ ì ì´ ìˆëŠ”ì§€ í™•ì¸
                // ì´ë¯¸ íƒìƒ‰í•œ ê²½ìš° ì¤‘ë³µ íƒìƒ‰ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ íì— ì¶”ê°€í•˜ì§€ ì•ŠìŒ
                if (!visited[cur_red[0]][cur_red[1]][cur_blue[0]][cur_blue[1]]) {
                    visited[cur_red[0]][cur_red[1]][cur_blue[0]][cur_blue[1]] = true;
                    // ì´ë™ íšŸìˆ˜ë¥¼ 1 ì¦ê°€ì‹œì¼œì„œ íì— ì¶”ê°€
                    queue.add(new int[] { cur_red[0], cur_red[1], cur_blue[0], cur_blue[1], status[4] + 1 });
                }
            }
        }

        // íƒìƒ‰ì„ ë§ˆì³¤ëŠ”ë° ë¹¨ê°„ êµ¬ìŠ¬ë§Œ ë¹ ì§„ ê²½ìš° ì´ë™ íšŸìˆ˜ ì¶œë ¥, ê·¸ ì™¸ì˜ ê²½ìš° -1 ì¶œë ¥
        // (íŒŒë€ êµ¬ìŠ¬ì´ ë¹ ì§€ì§€ ì•Šì•˜ê³  ë¹¨ê°„ êµ¬ìŠ¬ë§Œ ë¹ ì§„ ê²½ìš° ì„±ê³µ)
        bw.write((map[status[2]][status[3]] != 'O' && map[status[0]][status[1]] == 'O'? status[4]:-1) + "");
        bw.flush();
    }
}
```
